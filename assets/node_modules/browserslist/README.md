<h1 id="browserslist">Browserslist</h1>

<p>Library to share supported browsers list between different front-end tools.
It is used in <a href="https://github.com/postcss/autoprefixer">Autoprefixer</a>, <a href="http://stylelint.io/">Stylelint</a>, <a href="https://github.com/amilajack/eslint-plugin-compat">eslint-plugin-compat</a>
and <a href="https://github.com/babel/babel-preset-env">babel-env-preset</a>.</p>

<p>All tools that rely on Browserslist will find its config automatically,
when you add the following to <code>package.json</code>:</p>

<pre><code class="json">{
  "browserslist": [
    "&gt; 1%",
    "last 2 versions"
  ]
}
</code></pre>

<p>Or in <code>browserslist</code> config:</p>

<pre><code class="yaml"># Browsers that we support

&gt; 1%
Last 2 versions
IE 10 # sorry
</code></pre>

<p>Developers set browsers list in queries like <code>last 2 version</code>
to be free from updating browser versions manually.
Browserslist will use <a href="http://caniuse.com/">Can i Use</a> data for this queries.</p>

<p>Browserslist will take browsers queries from tool option,
<code>browserslist</code> config, <code>browserslist</code> section in <code>package.json</code>
or environment variables.</p>

<p>You can test Browserslist queries in <a href="http://browserl.ist/">online demo</a>.</p>

<p><a href="https://evilmartians.com/?utm_source=browserslist">
  <img src="https://evilmartians.com/badges/sponsored-by-evil-martians.svg"
    alt="Sponsored by Evil Martians"
    width="236"
    height="54"
  \>
</a></p>

<h2 id="queries">Queries</h2>

<p>Browserslist will use browsers query from one of this sources:</p>

<ol>
<li>Tool options. For example <code>browsers</code> option in Autoprefixer.</li>
<li><code>BROWSERSLIST</code> environment variable.</li>
<li><code>browserslist</code> config file in current or parent directories.</li>
<li><code>browserslist</code> key in <code>package.json</code> file in current or parent directories.</li>
<li>If the above methods did not produce a valid result
Browserslist will use defaults: <code>&gt; 1%, last 2 versions, Firefox ESR</code>.</li>
</ol>

<p>We recommend to write queries in <code>browserslist</code> config or <code>package.json</code>.</p>

<p>You can specify the versions by queries (case insensitive):</p>

<ul>
<li><code>last 2 versions</code>: the last 2 versions for each major browser.</li>
<li><code>last 2 Chrome versions</code>: the last 2 versions of Chrome browser.</li>
<li><code>&gt; 5%</code>: versions selected by global usage statistics.</li>
<li><code>&gt; 5% in US</code>: uses USA usage statistics. It accepts <a href="http://en.wikipedia.org/wiki/ISO_3166-1_alpha-2#Officially_assigned_code_elements">two-letter country code</a>.</li>
<li><code>&gt; 5% in my stats</code>: uses <a href="#custom-usage-data">custom usage data</a>.</li>
<li><code>ie 6-8</code>: selects an inclusive range of versions.</li>
<li><code>Firefox &gt; 20</code>: versions of Firefox newer than 20.</li>
<li><code>Firefox &gt;= 20</code>: versions of Firefox newer than or equal to 20.</li>
<li><code>Firefox &lt; 20</code>: versions of Firefox less than 20.</li>
<li><code>Firefox &lt;= 20</code>: versions of Firefox less than or equal to 20.</li>
<li><code>Firefox ESR</code>: the latest [Firefox ESR] version.</li>
<li><code>iOS 7</code>: the iOS browser version 7 directly.</li>
<li><code>not ie &lt;= 8</code>: exclude browsers selected before by previous queries.
You can add <code>not</code> to any query.</li>
</ul>

<p>Browserslist works with separated versions of browsers.
You should avoid queries like <code>Firefox &gt; 0</code>.</p>

<p>Multiple criteria are combined as a boolean <code>OR</code>. A browser version must match
at least one of the criteria to be selected.</p>

<p>All queries are based on the <a href="http://caniuse.com/">Can I Use</a> support table,
e.g. <code>last 3 iOS versions</code> might select <code>8.4, 9.2, 9.3</code> (mixed major and minor),
whereas <code>last 3 Chrome versions</code> might select <code>50, 49, 48</code> (major only).</p>

<h2 id="browsers">Browsers</h2>

<p>Names are case insensitive:</p>

<h3 id="major-browsers">Major Browsers</h3>

<ul>
<li><code>Chrome</code> for Google Chrome.</li>
<li><code>Firefox</code> or <code>ff</code> for Mozilla Firefox.</li>
<li><code>Explorer</code> or <code>ie</code> for Internet Explorer.</li>
<li><code>Edge</code> for Microsoft Edge.</li>
<li><code>iOS</code> or <code>ios_saf</code> for iOS Safari.</li>
<li><code>Opera</code> for Opera.</li>
<li><code>Safari</code> for desktop Safari.</li>
<li><code>ExplorerMobile</code> or <code>ie_mob</code> for Internet Explorer Mobile.</li>
</ul>

<h3 id="others">Others</h3>

<ul>
<li><code>Android</code> for Android WebView.</li>
<li><code>BlackBerry</code> or <code>bb</code> for Blackberry browser.</li>
<li><code>ChromeAndroid</code> or <code>and_chr</code> for Chrome for Android
(in Other section, because mostly same as common <code>Chrome</code>).</li>
<li><code>FirefoxAndroid</code> or <code>and_ff</code> for Firefox for Android.</li>
<li><code>OperaMobile</code> or <code>op_mob</code> for Opera Mobile.</li>
<li><code>OperaMini</code> or <code>op_mini</code> for Opera Mini.</li>
<li><code>Samsung</code> for Samsung Internet.</li>
<li><code>UCAndroid</code> or <code>and_uc</code> for UC Browser for Android.</li>
<li><code>Electron</code> for Electron framework. It will be converted to Chrome version.</li>
</ul>

<h3 id="electron">Electron</h3>

<p><a href="https://www.npmjs.com/package/electron-to-chromium"><code>electron-to-chromium</code></a>
could return a compatible Browserslist query
for your (major) Electron version:</p>

<pre><code class="js">const e2c = require('electron-to-chromium')
autoprefixer({
    browsers: e2c.electronToBrowserList('1.4') //=&gt; "Chrome &gt;= 53"
})
</code></pre>

<h2 id="config-file">Config File</h2>

<p>Browserslist config should be named <code>browserslist</code> and have browsers queries
split by a new line. Comments starts with <code>#</code> symbol:</p>

<pre><code class="yaml"># Browsers that we support

&gt; 1%
Last 2 versions
IE 8 # sorry
</code></pre>

<p>Browserslist will check config in every directory in <code>path</code>.
So, if tool process <code>app/styles/main.css</code>, you can put config to root,
<code>app/</code> or <code>app/styles</code>.</p>

<p>You can specify direct path in <code>BROWSERSLIST_CONFIG</code> environment variables.</p>

<h2 id="%60package.json%60"><code>package.json</code></h2>

<p>If you want to reduce config files in project root, you can specify
browsers in <code>package.json</code> with <code>browserslist</code> key:</p>

<pre><code class="js">{
  "private": true,
  "dependencies": {
    "autoprefixer": "^6.5.4"
  },
  "browserslist": [
    "&gt; 1%",
    "last 2 versions"
  ]
}
</code></pre>

<h2 id="environments">Environments</h2>

<p>You can also specify different browser queries for various environments.
Browserslist will choose query according to <code>BROWSERSLIST_ENV</code> or <code>NODE_ENV</code>
variables. If none of them is declared, Browserslist will firstly look
for <code>development</code> queries and then use defaults.</p>

<p>In <code>package.json</code>:</p>

<pre><code class="js">{
  …
  "browserslist": {
    "production": [
      "last 2 version",
      "ie 9"
    ],
    "development": [
      "last 1 version"
    ]
  }
}
</code></pre>

<p>In <code>browserslist</code> config:</p>

<pre><code class="ini">[production]
last 2 version
ie 9

[development]
last 1 version
</code></pre>

<h2 id="environment-variables">Environment Variables</h2>

<p>If some tool use Browserslist inside, you can change browsers settings
by <a href="https://en.wikipedia.org/wiki/Environment_variable">environment variables</a>:</p>

<ul>
<li><p><code>BROWSERSLIST</code> with browsers queries.</p>

<pre><code class="sh">BROWSERSLIST="&gt; 5%" gulp css
</code></pre></li>
<li><p><code>BROWSERSLIST_CONFIG</code> with path to config file.</p>

<pre><code class="sh">BROWSERSLIST_CONFIG=./config/browserslist gulp css
</code></pre></li>
<li><p><code>BROWSERSLIST_ENV</code> with environments string.</p>

<pre><code class="sh">BROWSERSLIST_ENV="development" gulp css
</code></pre></li>
<li><p><code>BROWSERSLIST_STATS</code> with path to the custom usage data
for <code>&gt; 1% in my stats</code> query.</p>

<pre><code class="sh">BROWSERSLIST_STATS=./config/usage_data.json gulp css
</code></pre></li>
</ul>

<h2 id="custom-usage-data">Custom Usage Data</h2>

<p>If you have a website, you can query against the usage statistics of your site:</p>

<ol>
<li>Import your Google Analytics data into <a href="http://caniuse.com/">Can I Use</a>.
Press <code>Import…</code> button in Settings page.</li>
<li><p>Open browser DevTools on <a href="http://caniuse.com/">Can I Use</a> and paste this snippet
into the browser console:</p>

<pre><code class="js">var e=document.createElement('a');e.setAttribute('href', 'data:text/plain;charset=utf-8,'+encodeURIComponent(JSON.stringify(JSON.parse(localStorage['usage-data-by-id'])[localStorage['config-primary_usage']])));e.setAttribute('download','stats.json');document.body.appendChild(e);e.click();document.body.removeChild(e);
</code></pre></li>
<li>Save the data to a <code>browserslist-stats.json</code> file in your project.</li>
</ol>

<p>Of course, you can generate usage statistics file by any other method.
File format should be like:</p>

<pre><code class="js">{
  "ie": {
    "6": 0.01,
    "7": 0.4,
    "8": 1.5
  },
  "chrome": {
    …
  },
  …
}
</code></pre>

<p>Note that you can query against your custom usage data
while also querying against global or regional data.
For example, the query <code>&gt; 1% in my stats, &gt; 5% in US, 10%</code> is permitted.</p>

<h2 id="js-api">JS API</h2>

<pre><code class="js">var browserslist = require('browserslist');

// Your CSS/JS build tool code
var process = function (source, opts) {
    var browsers = browserslist(opts.browsers, {
        stats: opts.stats,
        path:  opts.file,
        env:   opts.env
    });
    // Your code to add features for selected browsers
}
</code></pre>

<p>Queries can be a string <code>"&gt; 5%, last 1 version"</code>
or an array <code>['&gt; 5%', 'last 1 version']</code>.</p>

<p>If a query is missing, Browserslist will look for a config file.
You can provide a <code>path</code> option (that can be a file) to find the config file
relatively to it.</p>

<p>For non-JS environment and debug purpose you can use CLI tool:</p>

<pre><code class="sh">browserslist "&gt; 1%, last 2 versions"
</code></pre>

<h2 id="coverage">Coverage</h2>

<p>You can get total users coverage for selected browsers by JS API:</p>

<pre><code class="js">browserslist.coverage(browserslist('&gt; 1%')) //=&gt; 81.4
</code></pre>

<pre><code class="js">browserslist.coverage(browserslist('&gt; 1% in US'), 'US') //=&gt; 83.1
</code></pre>

<p>Or by CLI:</p>

<pre><code class="sh">$ browserslist --coverage "&gt; 1%"
These browsers account for 81.4% of all users globally
</code></pre>

<pre><code class="sh">$ browserslist --coverage=US "&gt; 1% in US"
These browsers account for 83.1% of all users in the US
</code></pre>
