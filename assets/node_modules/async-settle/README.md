<p align="center">
  <a href="http://gulpjs.com">
    <img height="257" width="114" src="https://raw.githubusercontent.com/gulpjs/artwork/master/gulp-2x.png">
  </a>
</p>

<h1 id="async-settle">async-settle</h1>

<p><a href="https://www.npmjs.com/package/async-settle"><img src="http://img.shields.io/npm/v/async-settle.svg" alt="NPM version" /></a> <a href="https://www.npmjs.com/package/async-settle"><img src="http://img.shields.io/npm/dm/async-settle.svg" alt="Downloads" /></a> <a href="https://travis-ci.org/gulpjs/async-settle"><img src="http://img.shields.io/travis/gulpjs/async-settle.svg?label=travis-ci" alt="Build Status" /></a> <a href="https://ci.appveyor.com/project/gulpjs/async-settle"><img src="https://img.shields.io/appveyor/ci/gulpjs/async-settle.svg?label=appveyor" alt="AppVeyor Build Status" /></a> <a href="https://coveralls.io/r/gulpjs/async-settle"><img src="http://img.shields.io/coveralls/gulpjs/async-settle/master.svg" alt="Coveralls Status" /></a> <a href="https://gitter.im/gulpjs/gulp"><img src="https://badges.gitter.im/gulpjs/gulp.svg" alt="Gitter chat" /></a></p>

<p>Settle an async function. It will always complete successfully with an object of the resulting state.</p>

<p>Handles completion and errors for callbacks, promises, observables and streams.</p>

<p>Will run call the function on <code>nextTick</code>. This will cause all functions to be async.</p>

<h2 id="usage">Usage</h2>

<h3 id="successful-completion">Successful completion</h3>

<pre><code class="js">var asyncSettle = require('async-settle');

asyncSettle(function(done){
  // do async things
  done(null, 2);
}, function(error, result){
  // `error` will ALWAYS be null on execution of the first function.
  // `result` will ALWAYS be a settled object with the result or error of the first function.
});
</code></pre>

<h3 id="failed-completion">Failed completion</h3>

<pre><code class="js">var asyncSettle = require('async-settle');

asyncSettle(function(done){
  // do async things
  done(new Error('Some Error Occurred'));
}, function(error, result){
  // `error` will ALWAYS be null on execution of the first function.
  // `result` will ALWAYS be a settled object with the result or error of the first function.
});
</code></pre>

<h2 id="api">API</h2>

<h3 id="%60asyncsettlefn%2C-callback%60"><code>asyncSettle(fn, callback)</code></h3>

<p>Takes a function to execute (<code>fn</code>) and a function to call on completion (<code>callback</code>).</p>

<h4 id="%60fndone%60"><code>fn([done])</code></h4>

<p>Optionally takes a callback (<code>done</code>) to call when async tasks are complete.</p>

<p>Executed in the context of <a href="https://github.com/gulpjs/async-done"><code>async-done</code></a>, with all errors and results being settled.</p>

<p>Completion is handled by <a href="https://github.com/gulpjs/async-done#completion-and-error-resolution"><code>async-done</code> completion and error resolution</a>.</p>

<h4 id="%60callbackerror%2C-result%60"><code>callback(error, result)</code></h4>

<p>Called on completion of <code>fn</code> and recieves a settled object as the <code>result</code> argument.</p>

<p>The <code>error</code> argument will always be <code>null</code>.</p>

<h4 id="settled-object">Settled Object</h4>

<p>Settled values have two properties, <code>state</code> and <code>value</code>.</p>

<p><code>state</code> has two possible options <code>'error'</code> and <code>'success'</code>.</p>

<p><code>value</code> will be the value passed to original callback.</p>

<h2 id="license">License</h2>

<p>MIT</p>
